<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Kaijyu + Spider (Dark Night Scene)</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  </head>
  <body style="background-color: black;">
    <a-scene>
      <!-- ðŸ”¦ ç…§æ˜Žï¼ˆã‹ãªã‚Šæš—ãï¼‰ -->
      <a-light type="ambient" color="#111"></a-light>
      <a-light type="directional" color="#555" intensity="0.3" position="2 4 3"></a-light>

      <!-- ðŸŒŒ èƒŒæ™¯ï¼ˆå¤œã®æ£®ã«è¦‹ãˆã‚‹ã‚ˆã†ã«æš—è‰²æŒ‡å®šï¼‰ -->
      <a-sky src="mori1.jpg" rotation="0 -130 0" color="#111"></a-sky>

      <!-- åŠ¹æžœéŸ³ -->
      <a-entity id="sound-player"></a-entity>

      <!-- ðŸŽ¥ ã‚«ãƒ¡ãƒ©ï¼ˆå°‘ã—ä¸‹ã’ãŸä½ç½®ï¼‰ -->
      <a-entity id="cameraRig" position="0 -1 5">
        <a-camera look-controls></a-camera>
      </a-entity>

      <!-- ðŸ¦– æ€ªç£ -->
      <a-assets>
        <a-asset-item id="kaijyu-asset" src="kaijyu.glb"></a-asset-item>
        <a-asset-item id="spider-asset" src="spider.glb"></a-asset-item>
      </a-assets>

      <a-entity
        id="kaijyu"
        gltf-model="#kaijyu-asset"
        position="0 -2.5 -10"
        rotation="0 0 0"
        scale="0.5 0.5 0.5"
        animation-mixer
        animation__move="property: position; to: 0 -2.5 5; dur: 25000; easing: linear; loop: false;"
      ></a-entity>

      <!-- ðŸ•·ï¸ ã‚¯ãƒ¢ï¼ˆ1åŒ¹ã ã‘ãƒ»é™æ­¢ï¼‰ -->
      <a-entity
        id="spider"
        gltf-model="#spider-asset"
        position="1 -2.5 -6"
        scale="0.2 0.2 0.2"
        rotation="0 30 0"
      ></a-entity>
    </a-scene>

    <script>
      // ðŸ¦– æ€ªç£ãƒ­ãƒ¼ãƒ‰å¾Œï¼šæš—é—‡ç”¨ã«ãƒžãƒ†ãƒªã‚¢ãƒ«ã‚’ã•ã‚‰ã«æš—ã
      const kaijyu = document.querySelector('#kaijyu');
      kaijyu.addEventListener('model-loaded', () => {
        kaijyu.object3D.traverse(node => {
          if (node.isMesh && node.material) {
            node.material.color.multiplyScalar(0.25); // ã‹ãªã‚Šæš—ã‚
          }
        });
        kaijyu.setAttribute('animation-mixer', 'clip: Walk; loop: repeat;');
      });

      // ðŸŽµ ãƒ©ãƒ³ãƒ€ãƒ åŠ¹æžœéŸ³ãƒ«ãƒ¼ãƒ—
      const soundFiles = [
        "åŠ¹æžœéŸ³/hell_gear.mp3",
        "åŠ¹æžœéŸ³/çªé¢¨ãŒå¹ã.mp3",
        "åŠ¹æžœéŸ³/é¢¨ãŒå¹ã1.mp3",
        "åŠ¹æžœéŸ³/é¢¨ãŒå¹ã2.mp3",
        "åŠ¹æžœéŸ³/é¢¨ãŒå¹ã3.mp3",
        "åŠ¹æžœéŸ³/é¢¨ãŒå¹ã4.mp3"
      ];

      const soundEntity = document.querySelector('#sound-player');
      function playRandomSound() {
        const randomSound = soundFiles[Math.floor(Math.random() * soundFiles.length)];
        soundEntity.setAttribute('sound', `src: url(${randomSound}); autoplay: true; volume: 0.9; loop: false;`);
        soundEntity.addEventListener('sound-loaded', () => {
          soundEntity.components.sound.playSound();
        }, { once: true });
      }

      function startRandomLoop() {
        playRandomSound();
        setInterval(() => {
          playRandomSound();
        }, Math.random() * 7000 + 8000);
      }

      window.addEventListener('load', startRandomLoop);
    </script>
  </body>
</html>
